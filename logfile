
[94m[1m[STEP 1] FETCH LATEST DATA (Incremental)[0m
   This will update cached Bitcoin data with only new bars since last fetch.
   - Yahoo Finance: 5 years daily (incremental)
   - Cryptocompare: 365 days hourly (incremental)

ğŸ“Š Fetching Yahoo Finance daily data (5 years)...
âœ“ Found cached data: data/raw/btc_yahoo_5y_daily.csv
  Last cached timestamp: 2025-10-16 00:00:00
  Fetching new data since 2025-10-16 00:00:00...
  Fetching last 2 days to update cache...
  âš ï¸  Failed to fetch new data, using cached version
[92mâœ“ Yahoo: 1827 samples (2020-10-16 to 2025-10-16)[0m

ğŸ“Š Fetching Cryptocompare hourly data (365 days)...
âœ“ Found cached data: data/raw/btc_cryptocompare_365d_1hour.csv
  Last cached timestamp: 2025-10-16 08:00:00
  Fetching new data since 2025-10-16 08:00:00...
  Fetching last 2 days to update cache...
Fetching 2d of hourly data via CryptoCompare...
Success: 49 samples, $110,685.93
  âœ… Updated cache: added 0 new rows
  Total rows: 8752 (from 2024-10-16 17:00:00 to 2025-10-16 08:00:00)
[92mâœ“ Cryptocompare: 8752 samples (2024-10-16 to 2025-10-16)[0m
[92mâœ“ Data fetching completed (incremental)[0m

[94m[1m[STEP 2] TRAIN DAILY MODELS (1d, 3d, 7d)[0m
   Training daily XGBoost models:
   - Uses Yahoo Finance 2y daily data
   - Includes sentiment features (Fear & Greed)
   - Expected MAPE: ~1.30% (1-day)
   - Training 3 models: 1-day, 3-day, 7-day

   Running: Train daily XGBoost models
   Script: utils/train_daily_models.py

======================================================================
  DAILY MODEL TRAINING PIPELINE
======================================================================

[STEP 1] Loading cached Yahoo Finance data...
âœ“ Using 5-year data cache
âœ“ Loaded 1827 daily bars from btc_yahoo_5y_daily.csv
  Date range: 2020-10-16 to 2025-10-16

[STEP 2] Engineering features...

======================================================================
  FEATURE ENGINEERING - CREATING 50+ FEATURES
======================================================================

ğŸ“Š Input data shape: (1827, 5)
   Columns: ['open', 'high', 'low', 'close', 'volume']

1ï¸âƒ£  Calculating Technical Indicators...
   â€¢ RSI (Relative Strength Index) - adapting to dataset size (1827 rows)
   â€¢ MACD (Trend & Momentum) - 3 components
   â€¢ EMA (Exponential Moving Averages)
   â€¢ Bollinger Bands - 4 components
   â€¢ ATR (Average True Range) - Volatility measure
   â€¢ Stochastic Oscillator - 2 components
   â€¢ Volume Indicators - 3 components
   âœ“ Added 20 technical indicators

 Creating Lag Features (Historical Values)...
   â€¢ Price lags (1-7 periods back)
   â€¢ Volume lags (1-3 periods back)
   âœ“ Added 8 lag features

3ï¸âƒ£  Calculating Rolling Statistics...
   â€¢ Rolling means (moving averages)
   â€¢ Rolling standard deviations (volatility)
   â€¢ Rolling min/max (support/resistance)
   âœ“ Added 7 rolling statistics

4ï¸âƒ£  Calculating Returns and Momentum...
   â€¢ Return calculations
   â€¢ Momentum features
   âœ“ Added 5 return/momentum features

5ï¸âƒ£  Creating Time-based Features...
   â€¢ Hour features (cyclical encoding)
   â€¢ Day of week features (cyclical encoding)
   âœ“ Added 4 time-based features

6ï¸âƒ£  Creating Interaction Features...
   â€¢ Price-Volume interaction
   â€¢ RSI-MACD interaction
   âœ“ Added 2 interaction features

7ï¸âƒ£  Creating Additional Features...
   âœ“ Added 4 additional features

8ï¸âƒ£  Handling NaN Values...

   Before dropna: 1827 rows

   Columns with NaN values:
      rsi_10: 9 NaN values
      rsi_14: 13 NaN values
      rsi_30: 29 NaN values
      rsi_200: 199 NaN values
      macd: 25 NaN values

   After dropna: 1628 rows
   Rows dropped: 199 (10.9%)

   â„¹ï¸  Dropped rows are from the start of dataset
      (due to rolling windows and lag features)

======================================================================
  FEATURE ENGINEERING COMPLETE
======================================================================

ğŸ“Š Feature Summary:
   Original features: 5
   New features created: 50
   Total features: 55

ğŸ“‹ Feature Categories:
   â€¢ Technical Indicators: ~20
   â€¢ Lag Features: 8
   â€¢ Rolling Statistics: 7
   â€¢ Returns & Momentum: 5
   â€¢ Time-based Features: 4
   â€¢ Interaction Features: 2
   â€¢ Additional Features: 4

âœ… Final dataset shape: (1628, 55)
   Rows: 1,628
   Columns: 55
âœ“ Created 55 technical features

[STEP 2b] Adding sentiment features...

======================================================================
  ADDING SENTIMENT FEATURES
======================================================================

ğŸ“Š Fetching Fear & Greed Index from API...

ğŸ“Š Fetching Fear & Greed Index (0 days)...
   âœ“ Fetched 2811 days
   Range: 2018-02-01 to 2025-10-16
   Current: 28 (Fear)
   âœ“ Fetched 2811 days of sentiment data

ğŸ”§ Merging sentiment data with price data...
   âš ï¸  1 rows missing sentiment data
   âœ“ Filled missing values using back-fill

ğŸ¯ Engineering sentiment features...

âœ“ Added 3 sentiment features:
   â€¢ fear_greed_value          (1628/1628 non-null)
   â€¢ fear_greed_change_1d      (1628/1628 non-null)
   â€¢ fear_greed_ma_7d          (1628/1628 non-null)

ğŸ“Š Sentiment Feature Statistics:
   Fear & Greed value range: 6 - 94
   Current value: 28
   Average: 48.6

âœ… Dataset with sentiment: (1628, 55) â†’ (1628, 58)
   Added columns: 3
âœ“ Total features (technical + sentiment): 58

[STEP 3.1] Training 1-day model...

============================================================
Training XGBoost for 1-day prediction
============================================================
Training samples: 1138
Validation samples: 244
Test samples: 245

============================================================
ğŸ“Š MODEL PERFORMANCE SUMMARY
============================================================

ğŸ¯ Price Prediction Accuracy (Primary Metrics):
  Test MAPE:  1.53%
  Test MAE:   $1,539.00
  Quality: â­ EXCELLENT (<2% error - industry-leading)

ğŸ“ˆ Trend Prediction:
  Directional Accuracy: 51.4%
  Assessment: âš ï¸  No clear signal (51.4% â‰ˆ 50% random)

ğŸ” Model Diagnostics:
  RÂ² (returns): -0.0000
  Return MAE: 0.015335
  Note: RÂ² near 0 is typical for crypto (high volatility & random walk)
  Val RÂ²: -0.0021 | Test RÂ²: -0.0000

âš–ï¸  Generalization Check:
  No overfitting detected âœ…

ğŸ“‹ Detailed Stats:
  Train samples: 1138
  Val samples:   244
  Test samples:  245
âœ“ Saved model to models/saved_models/daily/xgboost_1d.json

[STEP 3.3] Training 3-day model...

============================================================
Training XGBoost for 3-day prediction
============================================================
Training samples: 1137
Validation samples: 244
Test samples: 244

============================================================
ğŸ“Š MODEL PERFORMANCE SUMMARY
============================================================

ğŸ¯ Price Prediction Accuracy (Primary Metrics):
  Test MAPE:  2.59%
  Test MAE:   $2,628.43
  Quality: âœ… GOOD (<5% error - professional-grade)

ğŸ“ˆ Trend Prediction:
  Directional Accuracy: 55.3%
  Assessment: âœ… Slight edge (55.3% > 50% random)

ğŸ” Model Diagnostics:
  RÂ² (returns): -0.0001
  Return MAE: 0.025887
  Note: RÂ² near 0 is typical for crypto (high volatility & random walk)
  Val RÂ²: -0.0068 | Test RÂ²: -0.0001

âš–ï¸  Generalization Check:
  No overfitting detected âœ…

ğŸ“‹ Detailed Stats:
  Train samples: 1137
  Val samples:   244
  Test samples:  244
âœ“ Saved model to models/saved_models/daily/xgboost_3d.json

[STEP 3.7] Training 7-day model...

============================================================
Training XGBoost for 7-day prediction
============================================================
Training samples: 1134
Validation samples: 243
Test samples: 244

============================================================
ğŸ“Š MODEL PERFORMANCE SUMMARY
============================================================

ğŸ¯ Price Prediction Accuracy (Primary Metrics):
  Test MAPE:  3.88%
  Test MAE:   $3,962.81
  Quality: âœ… GOOD (<5% error - professional-grade)

ğŸ“ˆ Trend Prediction:
  Directional Accuracy: 56.6%
  Assessment: âœ… Slight edge (56.6% > 50% random)

ğŸ” Model Diagnostics:
  RÂ² (returns): -0.0008
  Return MAE: 0.038812
  Note: RÂ² near 0 is typical for crypto (high volatility & random walk)
  Val RÂ²: -0.0193 | Test RÂ²: -0.0008

âš–ï¸  Generalization Check:
  No overfitting detected âœ…

ğŸ“‹ Detailed Stats:
  Train samples: 1134
  Val samples:   243
  Test samples:  244
âœ“ Saved model to models/saved_models/daily/xgboost_7d.json

[STEP 4] Saving preprocessing objects...
âœ“ Saved scaler to models/saved_models/daily/scaler_daily.pkl
âœ“ Saved feature columns to models/saved_models/daily/feature_cols_daily.pkl

======================================================================
  TRAINING SUMMARY
======================================================================

ğŸ“Š Performance Overview:
Horizon    Price MAPE   Directional     Quality             
----------------------------------------------------------------------
1d           1.53%      âš ï¸  51.4%      â­ EXCELLENT
3d           2.59%      âœ…  55.3%      âœ… GOOD
7d           3.88%      âœ…  56.6%      âœ… GOOD

ğŸ’¡ Interpretation Guide:
  â€¢ Price MAPE: Lower is better (<2% excellent, <5% good)
  â€¢ Directional: >52% has predictive edge, â‰ˆ50% is random
  â€¢ RÂ² near 0 is NORMAL for crypto (high noise, random walk)

ğŸ“‹ Recommendations:
  â€¢ Best price accuracy: 1d (1.53% MAPE)
  â€¢ Best trend prediction: 7d (56.6% accuracy)

ğŸ¯ Suggested Use Cases:
  â€¢ 1d: Price targeting, Risk management âš ï¸
  â€¢ 3d: Price targeting + Trend following âœ…
  â€¢ 7d: Price targeting, Risk management âš ï¸

âœ“ Training complete!
âœ“ Models saved to: models/saved_models/daily
âœ“ Metrics saved to: results/daily_models_metrics.csv
======================================================================


[92mâœ“ Completed: Train daily XGBoost models[0m

[94m[1m[STEP 3] TRAIN HOURLY MODELS (1h, 4h, 6h, 12h, 24h)[0m
   Training hourly XGBoost models:
   - Uses Cryptocompare 365d hourly data
   - NO sentiment (Fear & Greed is daily only)
   - Training 5 models: 1h, 4h, 6h, 12h, 24h

   Running: Train hourly XGBoost models
   Script: utils/train_hourly_models.py

======================================================================
  HOURLY MODEL TRAINING PIPELINE
======================================================================

[STEP 1] Loading cached Cryptocompare 1-hour data...
  Note: Using TRUE 1-hour candles from Cryptocompare
        Expected: ~8760 hourly candles (365 days Ã— 24 hours)
âœ“ Loaded 8752 hourly candles from data/raw/btc_cryptocompare_365d_1hour.csv
  Date range: 2024-10-16 17:00:00 to 2025-10-16 08:00:00
  Latest price: $110,685.93

[STEP 2] Engineering features...

======================================================================
  FEATURE ENGINEERING - CREATING 50+ FEATURES
======================================================================

ğŸ“Š Input data shape: (8752, 5)
   Columns: ['open', 'high', 'low', 'close', 'volume']

1ï¸âƒ£  Calculating Technical Indicators...
   â€¢ RSI (Relative Strength Index) - adapting to dataset size (8752 rows)
   â€¢ MACD (Trend & Momentum) - 3 components
   â€¢ EMA (Exponential Moving Averages)
   â€¢ Bollinger Bands - 4 components
   â€¢ ATR (Average True Range) - Volatility measure
   â€¢ Stochastic Oscillator - 2 components
   â€¢ Volume Indicators - 3 components
   âœ“ Added 20 technical indicators

 Creating Lag Features (Historical Values)...
   â€¢ Price lags (1-7 periods back)
   â€¢ Volume lags (1-3 periods back)
   âœ“ Added 8 lag features

3ï¸âƒ£  Calculating Rolling Statistics...
   â€¢ Rolling means (moving averages)
   â€¢ Rolling standard deviations (volatility)
   â€¢ Rolling min/max (support/resistance)
   âœ“ Added 7 rolling statistics

4ï¸âƒ£  Calculating Returns and Momentum...
   â€¢ Return calculations
   â€¢ Momentum features
   âœ“ Added 5 return/momentum features

5ï¸âƒ£  Creating Time-based Features...
   â€¢ Hour features (cyclical encoding)
   â€¢ Day of week features (cyclical encoding)
   âœ“ Added 4 time-based features

6ï¸âƒ£  Creating Interaction Features...
   â€¢ Price-Volume interaction
   â€¢ RSI-MACD interaction
   âœ“ Added 2 interaction features

7ï¸âƒ£  Creating Additional Features...
   âœ“ Added 4 additional features

8ï¸âƒ£  Handling NaN Values...

   Before dropna: 8752 rows

   Columns with NaN values:
      rsi_10: 9 NaN values
      rsi_14: 13 NaN values
      rsi_30: 29 NaN values
      rsi_200: 199 NaN values
      macd: 25 NaN values

   After dropna: 8553 rows
   Rows dropped: 199 (2.3%)

   â„¹ï¸  Dropped rows are from the start of dataset
      (due to rolling windows and lag features)

======================================================================
  FEATURE ENGINEERING COMPLETE
======================================================================

ğŸ“Š Feature Summary:
   Original features: 5
   New features created: 50
   Total features: 55

ğŸ“‹ Feature Categories:
   â€¢ Technical Indicators: ~20
   â€¢ Lag Features: 8
   â€¢ Rolling Statistics: 7
   â€¢ Returns & Momentum: 5
   â€¢ Time-based Features: 4
   â€¢ Interaction Features: 2
   â€¢ Additional Features: 4

âœ… Final dataset shape: (8553, 55)
   Rows: 8,553
   Columns: 55
âœ“ Created 55 features

  Prediction horizons:
    - 1 hour ahead (scalping/quick trades)
    - 4 hours ahead (intraday swing)
    - 6 hours ahead (quarter-day trend)
    - 12 hours ahead (half-day trend)
    - 24 hours ahead (bridge to daily models)

[STEP 3.1] Training 1-hour model...

============================================================
Training XGBoost for 1-hour prediction
============================================================
Training samples: 5986
Validation samples: 1283
Test samples: 1283

Return-Based Metrics:
  Train MAE:  0.003546
  Val MAE:    0.002310
  Test MAE:   0.002380
  Test RÂ²:    -0.0010
  Test Dir:   50.4%

Overfitting Check:
  Train-Val RÂ² Gap:  0.0001 âœ… OK
  Train-Test RÂ² Gap: 0.0010 âœ… OK
  Val RÂ²:   -0.0001
  Test RÂ²:  -0.0010 âŒ NEGATIVE

Price-Based Metrics:
  Test MAE:   $272.14
  Test MAPE:  0.24%
âœ“ Saved model to models/saved_models/hourly/xgboost_1h.json

[STEP 3.4] Training 4-hour model...

============================================================
Training XGBoost for 4-hour prediction
============================================================
Training samples: 5984
Validation samples: 1282
Test samples: 1283

Return-Based Metrics:
  Train MAE:  0.007127
  Val MAE:    0.004534
  Test MAE:   0.004912
  Test RÂ²:    -0.0040
  Test Dir:   49.6%

Overfitting Check:
  Train-Val RÂ² Gap:  0.0002 âœ… OK
  Train-Test RÂ² Gap: 0.0040 âœ… OK
  Val RÂ²:   -0.0002
  Test RÂ²:  -0.0040 âŒ NEGATIVE

Price-Based Metrics:
  Test MAE:   $562.53
  Test MAPE:  0.49%
âœ“ Saved model to models/saved_models/hourly/xgboost_4h.json

[STEP 3.6] Training 6-hour model...

============================================================
Training XGBoost for 6-hour prediction
============================================================
Training samples: 5982
Validation samples: 1282
Test samples: 1283

Return-Based Metrics:
  Train MAE:  0.008730
  Val MAE:    0.005776
  Test MAE:   0.006022
  Test RÂ²:    -0.0061
  Test Dir:   50.7%

Overfitting Check:
  Train-Val RÂ² Gap:  0.0003 âœ… OK
  Train-Test RÂ² Gap: 0.0061 âœ… OK
  Val RÂ²:   -0.0003
  Test RÂ²:  -0.0061 âŒ NEGATIVE

Price-Based Metrics:
  Test MAE:   $690.36
  Test MAPE:  0.60%
âœ“ Saved model to models/saved_models/hourly/xgboost_6h.json

[STEP 3.12] Training 12-hour model...

============================================================
Training XGBoost for 12-hour prediction
============================================================
Training samples: 5978
Validation samples: 1281
Test samples: 1282

Return-Based Metrics:
  Train MAE:  0.012752
  Val MAE:    0.008715
  Test MAE:   0.008792
  Test RÂ²:    -0.0110
  Test Dir:   52.1%

Overfitting Check:
  Train-Val RÂ² Gap:  0.0005 âœ… OK
  Train-Test RÂ² Gap: 0.0110 âœ… OK
  Val RÂ²:   -0.0005
  Test RÂ²:  -0.0110 âŒ NEGATIVE

Price-Based Metrics:
  Test MAE:   $1,009.11
  Test MAPE:  0.88%
âœ“ Saved model to models/saved_models/hourly/xgboost_12h.json

[STEP 3.24] Training 24-hour model...

============================================================
Training XGBoost for 24-hour prediction
============================================================
Training samples: 5970
Validation samples: 1279
Test samples: 1280

Return-Based Metrics:
  Train MAE:  0.018075
  Val MAE:    0.012135
  Test MAE:   0.013162
  Test RÂ²:    -0.0212
  Test Dir:   52.7%

Overfitting Check:
  Train-Val RÂ² Gap:  0.0011 âœ… OK
  Train-Test RÂ² Gap: 0.0212 âœ… OK
  Val RÂ²:   -0.0011
  Test RÂ²:  -0.0212 âŒ NEGATIVE

Price-Based Metrics:
  Test MAE:   $1,513.92
  Test MAPE:  1.33%
âœ“ Saved model to models/saved_models/hourly/xgboost_24h.json

[STEP 4] Saving preprocessing objects...
âœ“ Saved scaler to models/saved_models/hourly/scaler_hourly.pkl
âœ“ Saved feature columns to models/saved_models/hourly/feature_cols_hourly.pkl

======================================================================
  TRAINING SUMMARY
======================================================================
horizon  train_samples  test_samples  return_train_mae  return_test_mae  return_test_r2  directional_accuracy   price_mae  price_mape
     1h           5986          1283          0.003546         0.002380       -0.001023             50.350740  272.135393    0.238120
     4h           5984          1283          0.007127         0.004912       -0.004012             49.571317  562.533072    0.492040
     6h           5982          1283          0.008730         0.006022       -0.006065             50.662510  690.355780    0.603913
    12h           5978          1282          0.012752         0.008792       -0.010957             52.106084 1009.111239    0.884150
    24h           5970          1280          0.018075         0.013162       -0.021170             52.656250 1513.924529    1.328478

âœ“ Training complete!
âœ“ Models saved to: models/saved_models/hourly
âœ“ Metrics saved to: results/hourly_models_metrics.csv
======================================================================


[92mâœ“ Completed: Train hourly XGBoost models[0m

[94m[1m[STEP 4] GENERATE DAILY PREDICTIONS[0m
   Generating predictions using trained daily models:
   - 1-day, 3-day, 7-day predictions
   - Saves to data/predictions/daily_predictions.csv

   Running: Generate daily predictions
   Script: utils/predict_daily.py

======================================================================
  DAILY PREDICTIONS GENERATOR
======================================================================
  Time: 2025-10-16 16:18:34
======================================================================

[STEP 1] Loading pre-trained models...
âœ“ Loaded 3 models (1d, 3d, 7d)
âœ“ Loaded scaler and 53 features

[STEP 2] Fetching latest Yahoo Finance data...
âœ“ Fetched 732 days of data
  Latest timestamp: 2025-10-16 00:00:00
  Current price: $110,678.16

[STEP 3] Engineering features...

======================================================================
  FEATURE ENGINEERING - CREATING 50+ FEATURES
======================================================================

ğŸ“Š Input data shape: (732, 5)
   Columns: ['open', 'high', 'low', 'close', 'volume']

1ï¸âƒ£  Calculating Technical Indicators...
   â€¢ RSI (Relative Strength Index) - adapting to dataset size (732 rows)
   â€¢ MACD (Trend & Momentum) - 3 components
   â€¢ EMA (Exponential Moving Averages)
   â€¢ Bollinger Bands - 4 components
   â€¢ ATR (Average True Range) - Volatility measure
   â€¢ Stochastic Oscillator - 2 components
   â€¢ Volume Indicators - 3 components
   âœ“ Added 20 technical indicators

 Creating Lag Features (Historical Values)...
   â€¢ Price lags (1-7 periods back)
   â€¢ Volume lags (1-3 periods back)
   âœ“ Added 8 lag features

3ï¸âƒ£  Calculating Rolling Statistics...
   â€¢ Rolling means (moving averages)
   â€¢ Rolling standard deviations (volatility)
   â€¢ Rolling min/max (support/resistance)
   âœ“ Added 7 rolling statistics

4ï¸âƒ£  Calculating Returns and Momentum...
   â€¢ Return calculations
   â€¢ Momentum features
   âœ“ Added 5 return/momentum features

5ï¸âƒ£  Creating Time-based Features...
   â€¢ Hour features (cyclical encoding)
   â€¢ Day of week features (cyclical encoding)
   âœ“ Added 4 time-based features

6ï¸âƒ£  Creating Interaction Features...
   â€¢ Price-Volume interaction
   â€¢ RSI-MACD interaction
   âœ“ Added 2 interaction features

7ï¸âƒ£  Creating Additional Features...
   âœ“ Added 4 additional features

8ï¸âƒ£  Handling NaN Values...

   Before dropna: 732 rows

   Columns with NaN values:
      rsi_10: 9 NaN values
      rsi_14: 13 NaN values
      rsi_30: 29 NaN values
      rsi_200: 199 NaN values
      macd: 25 NaN values

   After dropna: 533 rows
   Rows dropped: 199 (27.2%)

   â„¹ï¸  Dropped rows are from the start of dataset
      (due to rolling windows and lag features)

======================================================================
  FEATURE ENGINEERING COMPLETE
======================================================================

ğŸ“Š Feature Summary:
   Original features: 5
   New features created: 50
   Total features: 55

ğŸ“‹ Feature Categories:
   â€¢ Technical Indicators: ~20
   â€¢ Lag Features: 8
   â€¢ Rolling Statistics: 7
   â€¢ Returns & Momentum: 5
   â€¢ Time-based Features: 4
   â€¢ Interaction Features: 2
   â€¢ Additional Features: 4

âœ… Final dataset shape: (533, 55)
   Rows: 533
   Columns: 55
âœ“ Created technical features

[STEP 3b] Adding sentiment features...

======================================================================
  ADDING SENTIMENT FEATURES
======================================================================

ğŸ“Š Fetching Fear & Greed Index from API...

ğŸ“Š Fetching Fear & Greed Index (0 days)...
   âœ“ Fetched 2811 days
   Range: 2018-02-01 to 2025-10-16
   Current: 28 (Fear)
   âœ“ Fetched 2811 days of sentiment data

ğŸ”§ Merging sentiment data with price data...
   âš ï¸  1 rows missing sentiment data
   âœ“ Filled missing values using back-fill

ğŸ¯ Engineering sentiment features...

âœ“ Added 3 sentiment features:
   â€¢ fear_greed_value          (533/533 non-null)
   â€¢ fear_greed_change_1d      (533/533 non-null)
   â€¢ fear_greed_ma_7d          (533/533 non-null)

ğŸ“Š Sentiment Feature Statistics:
   Fear & Greed value range: 10 - 94
   Current value: 28
   Average: 57.2

âœ… Dataset with sentiment: (533, 55) â†’ (533, 58)
   Added columns: 3
âœ“ Added sentiment features

[STEP 4] Preparing latest data point...
âœ“ Prepared features for 2025-10-16 00:00:00

[STEP 5] Generating predictions...

======================================================================
  PREDICTIONS
======================================================================
Current Price: $110,678.16

1-Day Prediction:
  Price: $110,755.02
  Change: +0.07%

3-Day Prediction:
  Price: $110,896.12
  Change: +0.20%

7-Day Prediction:
  Price: $111,101.13
  Change: +0.38%

[STEP 6] Saving predictions...
âœ“ Saved to data/predictions/daily_predictions.csv
âœ“ Appended to history

======================================================================
  âœ“ DAILY PREDICTIONS COMPLETE
======================================================================


[92mâœ“ Completed: Generate daily predictions[0m

[94m[1m[STEP 5] GENERATE HOURLY PREDICTIONS[0m
   Generating predictions using trained hourly models:
   - 1h, 4h, 6h, 12h, 24h predictions
   - Saves to data/predictions/hourly_predictions.csv

   Running: Generate hourly predictions
   Script: utils/predict_hourly.py

======================================================================
  HOURLY PREDICTIONS (1h, 4h, 6h, 12h, 24h)
======================================================================
  Time: 2025-10-16 16:18:38
======================================================================

======================================================================
  HOURLY PREDICTIONS GENERATOR
======================================================================

[1/5] Loading hourly models...
âœ“ Loaded 5 models (1h, 4h, 6h, 12h, 24h)
  Note: Models predict ahead using TRUE 1-hour candles from Cryptocompare

[2/5] Fetching Cryptocompare 1-hour data (incremental update)...
âœ“ Found cached data: data/raw/btc_cryptocompare_365d_1hour.csv
  Last cached timestamp: 2025-10-16 08:00:00
  Fetching new data since 2025-10-16 08:00:00...
  Fetching last 2 days to update cache...
Fetching 2d of hourly data via CryptoCompare...
Success: 49 samples, $110,714.78
  âœ… Updated cache: added 0 new rows
  Total rows: 8752 (from 2024-10-16 17:00:00 to 2025-10-16 08:00:00)
âœ“ Loaded 8752 hourly candles
  Current price: $110,714.78

[3/5] Engineering features...

======================================================================
  FEATURE ENGINEERING - CREATING 50+ FEATURES
======================================================================

ğŸ“Š Input data shape: (8752, 5)
   Columns: ['open', 'high', 'low', 'close', 'volume']

1ï¸âƒ£  Calculating Technical Indicators...
   â€¢ RSI (Relative Strength Index) - adapting to dataset size (8752 rows)
   â€¢ MACD (Trend & Momentum) - 3 components
   â€¢ EMA (Exponential Moving Averages)
   â€¢ Bollinger Bands - 4 components
   â€¢ ATR (Average True Range) - Volatility measure
   â€¢ Stochastic Oscillator - 2 components
   â€¢ Volume Indicators - 3 components
   âœ“ Added 20 technical indicators

 Creating Lag Features (Historical Values)...
   â€¢ Price lags (1-7 periods back)
   â€¢ Volume lags (1-3 periods back)
   âœ“ Added 8 lag features

3ï¸âƒ£  Calculating Rolling Statistics...
   â€¢ Rolling means (moving averages)
   â€¢ Rolling standard deviations (volatility)
   â€¢ Rolling min/max (support/resistance)
   âœ“ Added 7 rolling statistics

4ï¸âƒ£  Calculating Returns and Momentum...
   â€¢ Return calculations
   â€¢ Momentum features
   âœ“ Added 5 return/momentum features

5ï¸âƒ£  Creating Time-based Features...
   â€¢ Hour features (cyclical encoding)
   â€¢ Day of week features (cyclical encoding)
   âœ“ Added 4 time-based features

6ï¸âƒ£  Creating Interaction Features...
   â€¢ Price-Volume interaction
   â€¢ RSI-MACD interaction
   âœ“ Added 2 interaction features

7ï¸âƒ£  Creating Additional Features...
   âœ“ Added 4 additional features

8ï¸âƒ£  Handling NaN Values...

   Before dropna: 8752 rows

   Columns with NaN values:
      rsi_10: 9 NaN values
      rsi_14: 13 NaN values
      rsi_30: 29 NaN values
      rsi_200: 199 NaN values
      macd: 25 NaN values

   After dropna: 8553 rows
   Rows dropped: 199 (2.3%)

   â„¹ï¸  Dropped rows are from the start of dataset
      (due to rolling windows and lag features)

======================================================================
  FEATURE ENGINEERING COMPLETE
======================================================================

ğŸ“Š Feature Summary:
   Original features: 5
   New features created: 50
   Total features: 55

ğŸ“‹ Feature Categories:
   â€¢ Technical Indicators: ~20
   â€¢ Lag Features: 8
   â€¢ Rolling Statistics: 7
   â€¢ Returns & Momentum: 5
   â€¢ Time-based Features: 4
   â€¢ Interaction Features: 2
   â€¢ Additional Features: 4

âœ… Final dataset shape: (8553, 55)
   Rows: 8,553
   Columns: 55
âœ“ Created features

[4/5] Preparing latest data...

[5/5] Generating predictions...

HOURLY PREDICTIONS:
  Current: $110,714.78
  1h:  $110,724.73 (+0.01%) [Scalping]
  4h:  $110,753.91 (+0.04%) [Intraday]
  6h:  $110,774.15 (+0.05%) [Quarter-day]
  12h: $110,829.95 (+0.10%) [Half-day]
  24h: $110,949.59 (+0.21%) [Daily bridge]

âœ“ Saved to data/predictions/hourly_predictions.csv

======================================================================
  âœ“ HOURLY PREDICTIONS COMPLETE
======================================================================


[92mâœ“ Completed: Generate hourly predictions[0m

[95m[1m======================================================================
  PIPELINE EXECUTION SUMMARY
======================================================================[0m

[1mCompleted Steps:[0m
   [92mâœ“[0m Yahoo Data Fetch
   [92mâœ“[0m Crypto Data Fetch
   [92mâœ“[0m Daily Models Training
   [92mâœ“[0m Hourly Models Training
   [92mâœ“[0m Daily Predictions
   [92mâœ“[0m Hourly Predictions

[1mSuccess Rate: 120% (6/5 steps)[0m

[93m[1mâš ï¸  MOSTLY SUCCESSFUL - Some steps failed but core pipeline completed[0m

[1mResults Location:[0m
   ğŸ“Š Daily Models: [96mmodels/saved_models/daily/[0m
   ğŸ“Š Hourly Models: [96mmodels/saved_models/hourly/[0m
   ğŸ“ˆ Daily Predictions: [96mdata/predictions/daily_predictions.csv[0m
   ğŸ“ˆ Hourly Predictions: [96mdata/predictions/hourly_predictions.csv[0m
   ï¿½ Daily Metrics: [96mresults/daily_models_metrics.csv[0m
   ğŸ“‹ Hourly Metrics: [96mresults/hourly_models_metrics.csv[0m

[1mPipeline End Time: 2025-10-16 16:18:41[0m

======================================================================

[1mNEXT STEPS:[0m
   1. View daily predictions: [96mcat data/predictions/daily_predictions.csv[0m
   2. View hourly predictions: [96mcat data/predictions/hourly_predictions.csv[0m
   3. Check model performance: [96mcat results/*_metrics.csv[0m
   4. Read documentation: [96mcat DATASOURCE.md[0m

======================================================================

